## 0002 - Migrate Remaining App to Vuetify 3

### Context
Migrate the rest of the app to Vuetify 3 while keeping behavior intact. The Today tab has already been migrated; this plan covers all other areas. Deliver an incremental rollout that keeps the app stable.

- “Migrating the rest of the app to Vuetify 3” (besides the Today tab)
- Use Vuetify component equivalents (e.g., buttons → `v-btn`, forms → `v-form`, navigation → `v-bottom-navigation`/`v-navigation-drawer` as applicable)
- Prioritize MVP parity first, then enhancements

### Files To Change / Create
- `src/plugins/vuetify.js` (theme, component defaults)
- `src/main.js` (confirm registration; no change expected)
- `src/App.vue` (wrap content in `v-main`/`v-container`; replace logout button)
- `src/components/BottomNav.vue` (replace with `v-bottom-navigation`)
- `src/components/AuthForm.vue` (use `v-form`, `v-text-field`, `v-btn`, `v-alert`)
- `src/components/AddExpenseModal.vue` (refactor to `v-dialog` + `v-card`, `v-text-field`/`v-autocomplete`, `v-btn`)
- `src/components/EditExpenseModal.vue` (same as Add; include date input)
- `src/components/MonthView.vue` (lists/groups via `v-expansion-panels` or `v-list-group`; totals)
- `src/components/ChatModal.vue` (dialog, inputs, buttons, error `v-alert`)
- `src/components/Toasts.vue` (render toast queue via `v-snackbar`; optional `v-alert` content)
- `src/components/AutocompleteInput.vue` (convert to `v-autocomplete`)
- References only (no UI change expected): `src/lib/supabase.js`

---

### 1) Global Setup

- Ensure Vuetify availability
  - Keep plugin single-source at `src/plugins/vuetify.js`; keep MDI icon set.
  - Root stays wrapped in `<v-app>` (already in `App.vue`). For page content, use `<v-main>` with a centered `<v-container>`.

- Theme and defaults
  - Define light/dark themes with tokens:
    - `primary: #2563EB` (Tailwind blue-600), `secondary`, `success`, `warning`, `error`, `info`.
  - Set `defaults` for component look/feel:
    - `VBtn`: `density: 'comfortable'`, `rounded: 'md'`.
    - `VTextField`: `density: 'comfortable'`, `variant: 'outlined'`.
    - `VDialog`: `transition: 'dialog-bottom-transition'` (mobile-friendly).

- Typography and spacing
  - Use Vuetify text classes (`text-h5`, `text-h6`, `text-body-1`).
  - Favor Vuetify grid: `v-container` → `v-row` → `v-col` for page layout.

- Layout container standard
  - Wrap page bodies with `v-container` centered, with a consistent max width (≈ 700px) to match existing app feel.

Notes: Tailwind may remain in non-migrated areas during transition; prefer Vuetify utilities when migrating.

---

### 2) Component Strategy

- Mappings
  - Buttons → `v-btn` (+ `v-icon`)
  - Inputs → `v-text-field`, `v-textarea`, `v-autocomplete`, `v-select`
  - Forms/validation → `v-form` + `rules`
  - Modals/sheets → `v-dialog` + `v-card` (+ `v-toolbar`/`v-card-title`)
  - Lists → `v-list`, `v-list-item`, `v-divider`
  - Navigation → `v-bottom-navigation` (current bottom tabs). `v-navigation-drawer` is available if needed later.
  - Layout → `v-container`, `v-row`, `v-col`, `v-sheet`, `v-card`
  - Alerts/empty → `v-alert`
  - Skeletons → `v-skeleton-loader`
  - Feedback → `v-snackbar` (optionally with `v-alert` styling inside)
  - Grouping/expand → `v-expansion-panels` or `v-list-group`

- Replace custom UI with Vuetify equivalents while preserving props/emits.

---

### 3) Page-by-Page Migration Plan (besides Today)

- App shell (`src/App.vue`)
  - Replace logout button with `v-btn` (text/tonal).
  - Wrap content inside `<v-main><v-container class="mx-auto" style="max-width: 700px"></v-container></v-main>`.

- Auth (`src/components/AuthForm.vue`)
  - Convert to `v-form` with `v-text-field` for email/password.
  - Submit `v-btn` (disabled while loading); optional `v-progress-circular` in button.
  - Show `v-alert` for `errorMessage` and `infoMessage`.
  - MVP: identical behavior. Enhancements: validation rules, password visibility toggle, enter-to-submit.

- Month view (`src/components/MonthView.vue`)
  - Header: `v-row` with `text-h6` month title.
  - Groups: use `v-expansion-panels` with `multiple` (multi-open) OR `v-list-group` per base item name. Header shows base name, count, and sum.
  - Items: inside each group, `v-list` with `v-list-item` for item name, date (subtitle/append), and amount in append slot. Separate with `v-divider`.
  - Empty state: `v-alert` (info, tonal).
  - Total row: `v-row` with bold text and optional `v-divider` above.
  - MVP: parity of grouping/sorting/totals. Enhancements: search/filter, sticky group headers.

- Bottom navigation (`src/components/BottomNav.vue`)
  - Replace markup with `v-bottom-navigation` and 3 `v-btn` actions (Day, Month, Chat) using `prepend-icon` MDI icons.
  - Keep existing `@click` emits contract `navigate` to avoid changes in `App.vue`.

- Add expense modal (`src/components/AddExpenseModal.vue`)
  - Use `v-dialog` + `v-card` with title and actions.
  - Inputs: `v-autocomplete` (for item suggestions) and `v-text-field` with `type="number"`/`inputmode="decimal"` for cost.
  - `v-form` with rules; disable Save until valid. Keep payload `{ item, cost, date }` consistent.

- Edit expense modal (`src/components/EditExpenseModal.vue`)
  - Same shell as Add; add date input (`v-text-field type="date"`).
  - Buttons: primary Save (disabled while invalid), outlined Delete, text Cancel.

- Chat modal (`src/components/ChatModal.vue`)
  - `v-dialog` + `v-card`. Body as scrollable `v-sheet` or `v-list` of messages.
  - Input row: `v-text-field` bound to `input`, `v-btn` Send; disable while sending, optional loading adornment.
  - Error line as `v-alert` (error, dense). Preserve `emit('close')` and `emit('added')` contracts.

- Toasts (`src/components/Toasts.vue`)
  - Render queue as stacked `v-snackbar`s. Map existing `type` to color: error, success, info.
  - Include optional `v-btn` actions for Copy and Close.

- Autocomplete (`src/components/AutocompleteInput.vue`)
  - Replace with `v-autocomplete`, keeping `v-model` and suggestions support.

---

### 4) Incremental Rollout

- Order (ship safely after each step):
  1) Bottom navigation
  2) Auth form
  3) Add/Edit modals
  4) Month view
  5) Chat modal
  6) Toasts

- Hybrid handling
  - Mixed Tailwind + Vuetify is acceptable during transition; scope Vuetify styles to migrated components.
  - Preserve props/emits to avoid upstream changes. Introduce a small feature flag for the new toast system for easy rollback if needed.

- Stability
  - After each migration step, run the app and a production build; fix any warnings.
  - MVP parity first; enhancements in follow-ups.

---

### 5) Testing & QA

- Functional checks
  - Auth: signup/signin flows, required validation, loading states, error/info alerts.
  - Bottom navigation: tab switching and chat modal opening across breakpoints.
  - Add/Edit modals: validation, focus trap, ESC/Cancel, save/delete flows.
  - Month view: grouping correctness, sorting, expand/collapse, totals, empty state.
  - Chat modal: sending, disabled state, error rendering, scroll behavior.
  - Toasts: stacking, auto-dismiss, manual dismiss, Copy action.

- UI consistency
  - Theme tokens (primary/success/error) appear consistent across `v-btn`, fields, and alerts.
  - Density and typography scale align between pages; use Vuetify text utilities (`text-h6`, `text-body-1`).
  - Mobile-first QA: iOS Safari and Android Chrome; dialogs’ keyboard handling and safe-area spacing.

- Accessibility
  - Verify labels, focus states, tab order; `ESC` closes dialogs; screen-reader text where needed.

- Performance
  - Monitor bundle size; prefer Vuetify built-ins over custom heavy DOM.

- Regression run
  - Login → Today (existing) → Month → Add/Edit → Chat → Logout.
  - Confirm a clean `npm run build` after all migrations.